# =============================================================================
# BRF Portal - Production Environment Variables EXAMPLE
# =============================================================================
# 
# This file contains production-ready environment variable examples.
# Copy this file to .env.production and fill in your actual values.
# 
# CRITICAL SECURITY WARNING:
# - NEVER commit .env.production to version control
# - Use a secrets management system (AWS Secrets Manager, Azure Key Vault, etc.)
# - Generate strong, unique values for all secrets
# - Rotate secrets regularly
# - Use encrypted storage for all sensitive data
#
# =============================================================================

# =============================================================================
# PRODUCTION ENVIRONMENT SETTINGS
# =============================================================================

NODE_ENV=production
NEXT_PUBLIC_APP_URL=https://brfportal.se
DEBUG=false

# =============================================================================
# DATABASE (PostgreSQL with connection pooling)
# =============================================================================

# Use a secure PostgreSQL connection with SSL
DATABASE_URL=postgresql://username:password@postgres.brfportal.se:5432/brf_portal_prod?sslmode=require
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=50
DATABASE_POOL_TIMEOUT=30
DATABASE_LOG_QUERIES=false
DATABASE_BACKUP_ENABLED=true
DATABASE_BACKUP_SCHEDULE=0 2 * * *
DATABASE_BACKUP_RETENTION_DAYS=90

# =============================================================================
# AUTHENTICATION & SECURITY (Production-grade)
# =============================================================================

# Generate with: openssl rand -base64 32
NEXTAUTH_URL=https://brfportal.se
NEXTAUTH_SECRET=REPLACE_WITH_STRONG_32_CHAR_SECRET_FROM_SECRETS_MANAGER

# Strong password requirements for production
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=true

# Security keys (use secrets manager!)
ENCRYPTION_KEY=REPLACE_WITH_STRONG_32_CHAR_ENCRYPTION_KEY
JWT_SIGNING_KEY=REPLACE_WITH_STRONG_32_CHAR_JWT_KEY

# CSRF and security headers
CSRF_SECRET=REPLACE_WITH_STRONG_CSRF_SECRET
CSP_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true

# CORS for production domain
CORS_ORIGIN=https://brfportal.se

# =============================================================================
# SWEDISH BANKID INTEGRATION (Production)
# =============================================================================

# BankID Production Environment (costs: â‚¬49/month + per use)
BANKID_ENABLED=true
BANKID_ENVIRONMENT=production
BANKID_API_URL=https://appapi2.bankid.com/rp/v6.0
BANKID_CLIENT_CERT_PATH=/secure/certs/bankid-client-prod.p12
BANKID_CLIENT_CERT_PASSWORD=FROM_SECRETS_MANAGER
BANKID_CA_CERT_PATH=/secure/certs/bankid-ca-prod.crt
BANKID_TIMEOUT_SECONDS=90
BANKID_MAX_RETRIES=3

# Disable fallback auth in production
ENABLE_EMAIL_AUTH=true  # Keep as backup
ENABLE_TEST_USERS=false

# Disable all mocks in production
MOCK_BANKID=false
MOCK_EMAIL=false
MOCK_SMS=false
MOCK_PAYMENT=false
MOCK_EXTERNAL_APIS=false

# =============================================================================
# EXTERNAL APIS (Production with real keys)
# =============================================================================

# OpenAI for AI processing (cost: pay per use)
OPENAI_API_KEY=FROM_SECRETS_MANAGER
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=4000
OPENAI_TEMPERATURE=0.1

# OCR Service
OCR_SERVICE_URL=https://ocr.brfportal.se
OCR_API_KEY=FROM_SECRETS_MANAGER

# =============================================================================
# SWEDISH BUSINESS INTEGRATIONS (Production APIs)
# =============================================================================

# Fortnox Production API
FORTNOX_API_URL=https://api.fortnox.se/3
FORTNOX_CLIENT_SECRET=FROM_SECRETS_MANAGER
FORTNOX_ACCESS_TOKEN=FROM_SECRETS_MANAGER

# Visma eEkonomi Production API
VISMA_API_URL=https://eaccountingapi.vismaonline.com/v2
VISMA_CLIENT_ID=FROM_SECRETS_MANAGER
VISMA_CLIENT_SECRET=FROM_SECRETS_MANAGER
VISMA_REDIRECT_URI=https://brfportal.se/api/auth/visma/callback

# Kivra Digital Mailbox
KIVRA_API_URL=https://api.kivra.com/v1
KIVRA_API_KEY=FROM_SECRETS_MANAGER
KIVRA_SENDER_ID=FROM_SECRETS_MANAGER

# Swedish Business Registry
BOLAGSVERKET_API_URL=https://api.bolagsverket.se/v1
BOLAGSVERKET_API_KEY=FROM_SECRETS_MANAGER

# =============================================================================
# PAYMENT SYSTEMS (Production)
# =============================================================================

# Swish Production API
SWISH_API_URL=https://mss.cpc.getswish.net
SWISH_MERCHANT_ID=FROM_SECRETS_MANAGER
SWISH_CLIENT_CERT_PATH=/secure/certs/swish-prod.p12
SWISH_CLIENT_CERT_PASSWORD=FROM_SECRETS_MANAGER

# Bankgirot Production
BANKGIROT_API_URL=https://api.bankgirot.se
BANKGIROT_CUSTOMER_ID=FROM_SECRETS_MANAGER
BANKGIROT_API_KEY=FROM_SECRETS_MANAGER

# Autogiro Direct Debit
AUTOGIRO_CUSTOMER_NUMBER=FROM_SECRETS_MANAGER
AUTOGIRO_BANK_ACCOUNT=FROM_SECRETS_MANAGER

# Stripe (if needed for international)
STRIPE_PUBLISHABLE_KEY=pk_live_FROM_SECRETS_MANAGER
STRIPE_SECRET_KEY=sk_live_FROM_SECRETS_MANAGER
STRIPE_WEBHOOK_SECRET=whsec_FROM_SECRETS_MANAGER

# =============================================================================
# FILE STORAGE (Production AWS S3)
# =============================================================================

# AWS S3 in Stockholm region for Swedish data residency
AWS_REGION=eu-north-1
AWS_ACCESS_KEY_ID=FROM_SECRETS_MANAGER
AWS_SECRET_ACCESS_KEY=FROM_SECRETS_MANAGER
AWS_S3_BUCKET=brf-portal-documents-prod
AWS_S3_BUCKET_REGION=eu-north-1

# File limits (production-ready)
MAX_FILE_SIZE=100MB
MAX_TOTAL_SIZE=1GB
ALLOWED_FILE_TYPES=pdf,jpg,jpeg,png,doc,docx,xls,xlsx,txt

# Document processing
DOCUMENT_QUEUE_ENABLED=true
DOCUMENT_PROCESSING_TIMEOUT=600  # 10 minutes for large files

# =============================================================================
# EMAIL SERVICES (Production)
# =============================================================================

# Production email service (choose one)
SENDGRID_API_KEY=FROM_SECRETS_MANAGER
# OR
MAILGUN_API_KEY=FROM_SECRETS_MANAGER
MAILGUN_DOMAIN=mg.brfportal.se

# Email configuration
FROM_EMAIL=noreply@brfportal.se
FROM_NAME=BRF Portal
REPLY_TO_EMAIL=support@brfportal.se
EMAIL_BASE_URL=https://brfportal.se

# =============================================================================
# SMS SERVICES (Production)
# =============================================================================

# 46elks (Swedish SMS provider)
SMS_PROVIDER=46elks
SMS_API_URL=https://api.46elks.com/a1
SMS_API_USERNAME=FROM_SECRETS_MANAGER
SMS_API_PASSWORD=FROM_SECRETS_MANAGER
SMS_FROM_NUMBER=BRFPortal

# =============================================================================
# PUSH NOTIFICATIONS (Production Firebase)
# =============================================================================

FIREBASE_PROJECT_ID=brf-portal-prod
FIREBASE_PRIVATE_KEY_ID=FROM_SECRETS_MANAGER
FIREBASE_PRIVATE_KEY=FROM_SECRETS_MANAGER_MULTILINE
FIREBASE_CLIENT_EMAIL=firebase-adminsdk@brf-portal-prod.iam.gserviceaccount.com
FIREBASE_CLIENT_ID=FROM_SECRETS_MANAGER

# =============================================================================
# ENERGY OPTIMIZATION APIS (When revenue supports costs)
# =============================================================================

# Sally R Energy API (~1500 SEK/month)
SALLY_R_API_KEY=FROM_SECRETS_MANAGER
SALLY_R_API_URL=https://api.sallyr.com/v1

# Eliq Energy Data API
ELIQ_API_KEY=FROM_SECRETS_MANAGER
ELIQ_API_URL=https://api.eliq.se/v1

# =============================================================================
# CACHING & PERFORMANCE (Production Redis)
# =============================================================================

# Production Redis cluster
REDIS_URL=rediss://username:password@redis.brfportal.se:6380
REDIS_PASSWORD=FROM_SECRETS_MANAGER
REDIS_DB=0

# Cache settings for production load
CACHE_TTL_DEFAULT=7200   # 2 hours
CACHE_TTL_STATIC=86400   # 24 hours
CACHE_TTL_DYNAMIC=300    # 5 minutes

# Rate limiting for production
RATE_LIMIT_WINDOW=900    # 15 minutes
RATE_LIMIT_MAX=1000      # Higher for production
RATE_LIMIT_SKIP_SUCCESSFUL=true

# =============================================================================
# MONITORING & LOGGING (Production)
# =============================================================================

# Sentry for error tracking
SENTRY_DSN=FROM_SECRETS_MANAGER
SENTRY_ENVIRONMENT=production
SENTRY_TRACE_SAMPLE_RATE=0.01  # 1% sampling in production

# Production logging
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_ENABLED=true
LOG_FILE_PATH=/var/log/brf-portal/app.log
LOG_FILE_MAX_SIZE=50MB
LOG_FILE_MAX_FILES=10

# Performance monitoring
PERFORMANCE_MONITORING_ENABLED=true
SLOW_QUERY_THRESHOLD=500  # ms

# =============================================================================
# GDPR & COMPLIANCE (Production)
# =============================================================================

# Swedish law compliance (7 years retention)
GDPR_DATA_RETENTION_DEFAULT=2555
GDPR_LOG_RETENTION=2555
GDPR_SESSION_RETENTION=30

# Compliance features
COOKIE_CONSENT_REQUIRED=true
DATA_EXPORT_ENABLED=true
DATA_DELETION_ENABLED=true
DATA_ANONYMIZATION_ENABLED=true

# =============================================================================
# FEATURE FLAGS (Production)
# =============================================================================

# Core production features
FEATURE_BANKID_AUTH=true
FEATURE_AI_PROCESSING=true
FEATURE_PAYMENT_PROCESSING=true
FEATURE_EMAIL_NOTIFICATIONS=true
FEATURE_SMS_NOTIFICATIONS=true

# Premium features (enable when paying customers)
FEATURE_ENERGY_OPTIMIZATION=true
FEATURE_ADVANCED_ANALYTICS=true
FEATURE_WHITE_LABEL=false
FEATURE_API_ACCESS=true

# =============================================================================
# DEPLOYMENT & INFRASTRUCTURE (Production)
# =============================================================================

DEPLOYMENT_ENV=production
DEPLOYMENT_REGION=eu-north-1
DEPLOYMENT_VERSION=1.0.0

# Health checks
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_ENDPOINT=/api/health
HEALTH_CHECK_TIMEOUT=3000

# Auto-scaling
AUTO_SCALE_MIN_INSTANCES=3
AUTO_SCALE_MAX_INSTANCES=50
AUTO_SCALE_TARGET_CPU=60

# Backup configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_S3_BUCKET=brf-portal-backups-prod
BACKUP_RETENTION_DAYS=2555  # 7 years per Swedish law

# =============================================================================
# PRODUCTION API QUOTAS & LIMITS
# =============================================================================

# Production API limits
API_RATE_LIMIT_PER_HOUR=50000
API_RATE_LIMIT_PER_DAY=1000000

# Production quotas
OPENAI_MONTHLY_QUOTA=10000000    # 10M tokens
BANKID_MONTHLY_QUOTA=100000      # 100k authentications
SMS_MONTHLY_QUOTA=10000          # 10k messages

# =============================================================================
# MULTI-TENANT PRODUCTION
# =============================================================================

MULTI_TENANT_MODE=true
ENABLE_SUBDOMAIN_ROUTING=true
BASE_DOMAIN=brfportal.se
WILDCARD_DOMAIN=*.brfportal.se
MAX_TENANTS_PER_INSTANCE=10000

# =============================================================================
# LOCALIZATION (Production)
# =============================================================================

DEFAULT_LOCALE=sv-SE
SUPPORTED_LOCALES=sv-SE,en-US,fi-FI,da-DK,no-NO
DEFAULT_CURRENCY=SEK

# Translation service for premium features
TRANSLATION_API_KEY=FROM_SECRETS_MANAGER
AUTO_TRANSLATE_ENABLED=true

# =============================================================================
# IMPORTANT PRODUCTION DEPLOYMENT NOTES
# =============================================================================
#
# 1. SECRETS MANAGEMENT:
#    - Never put real secrets in this file
#    - Use AWS Secrets Manager, Azure Key Vault, or similar
#    - Rotate all secrets regularly (quarterly minimum)
#
# 2. SSL/TLS CERTIFICATES:
#    - Ensure all certificates are valid and up-to-date
#    - Use Let's Encrypt or commercial certificates
#    - Monitor certificate expiration
#
# 3. DATABASE SECURITY:
#    - Use encrypted connections (sslmode=require)
#    - Regular backups with encryption
#    - Access from approved IPs only
#
# 4. MONITORING:
#    - Set up alerts for all critical metrics
#    - Monitor API quotas and costs
#    - Track performance and errors
#
# 5. COMPLIANCE:
#    - Regular security audits
#    - GDPR compliance monitoring
#    - Data retention policy enforcement
#
# 6. DISASTER RECOVERY:
#    - Test backup and restore procedures
#    - Document recovery processes
#    - Maintain offsite backups
#
# =============================================================================