# =============================================================================
# BRF Portal - Environment Variables Configuration
# =============================================================================
# 
# This file contains all environment variables needed for the BRF Portal
# Swedish housing cooperative management platform.
#
# IMPORTANT SECURITY NOTES:
# - Never commit actual values to version control
# - Use different values for each environment
# - Generate strong, unique secrets for production
# - Regularly rotate API keys and secrets
# - Use encrypted storage in production (AWS Secrets Manager, etc.)
#
# =============================================================================

# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================

# Environment type (development, staging, production)
NODE_ENV=development

# Application URL (used for redirects, webhooks, etc.)
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Application name and version
NEXT_PUBLIC_APP_NAME="BRF Portal"
NEXT_PUBLIC_APP_VERSION="1.0.0"

# Enable debug logging in development
DEBUG=true

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Development: SQLite (zero cost, local development)
DATABASE_URL="file:./database/brf_portal.db"

# Production: PostgreSQL with connection pooling
# DATABASE_URL="postgresql://username:password@host:5432/database?schema=public"

# Database connection pool settings (for PostgreSQL)
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_POOL_TIMEOUT=30

# Enable database query logging in development
DATABASE_LOG_QUERIES=true

# Database backup configuration
DATABASE_BACKUP_ENABLED=false
DATABASE_BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
DATABASE_BACKUP_RETENTION_DAYS=30

# =============================================================================
# AUTHENTICATION & SESSION CONFIGURATION
# =============================================================================

# NextAuth.js configuration
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your-super-secret-nextauth-key-minimum-32-characters

# Session configuration
SESSION_TIMEOUT=86400  # 24 hours in seconds
REFRESH_TOKEN_EXPIRY=604800  # 7 days in seconds

# Password requirements
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=true

# =============================================================================
# SWEDISH BANKID INTEGRATION
# =============================================================================

# BankID API Configuration (Production: paid service ~â‚¬49/month + per use)
BANKID_ENABLED=false  # Set to true in production
BANKID_ENVIRONMENT=test  # test or production
BANKID_API_URL=https://appapi2.test.bankid.com/rp/v6.0
BANKID_CLIENT_CERT_PATH=/path/to/bankid-client.p12
BANKID_CLIENT_CERT_PASSWORD=your-bankid-cert-password
BANKID_CA_CERT_PATH=/path/to/bankid-ca.crt

# BankID timeout settings
BANKID_TIMEOUT_SECONDS=60
BANKID_MAX_RETRIES=3

# Fallback authentication for development/testing
ENABLE_EMAIL_AUTH=true
ENABLE_TEST_USERS=true

# =============================================================================
# EXTERNAL APIS & INTEGRATIONS
# =============================================================================

# OpenAI API for document processing and AI features
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4
OPENAI_MAX_TOKENS=4000
OPENAI_TEMPERATURE=0.1

# Alternative AI providers (for cost optimization)
ANTHROPIC_API_KEY=your-anthropic-api-key
GOOGLE_AI_API_KEY=your-google-ai-api-key

# OCR Service (for document text extraction)
OCR_SERVICE_URL=http://localhost:8000  # Local FastAPI service
OCR_API_KEY=your-ocr-service-key

# =============================================================================
# SWEDISH BUSINESS INTEGRATIONS
# =============================================================================

# Fortnox API (Accounting system integration)
FORTNOX_API_URL=https://api.fortnox.se/3
FORTNOX_CLIENT_SECRET=your-fortnox-client-secret
FORTNOX_ACCESS_TOKEN=your-fortnox-access-token

# Visma eEkonomi API (Alternative accounting system)
VISMA_API_URL=https://eaccountingapi.vismaonline.com/v2
VISMA_CLIENT_ID=your-visma-client-id
VISMA_CLIENT_SECRET=your-visma-client-secret
VISMA_REDIRECT_URI=http://localhost:3000/api/auth/visma/callback

# Kivra API (Digital mailbox service)
KIVRA_API_URL=https://api.kivra.com/v1
KIVRA_API_KEY=your-kivra-api-key
KIVRA_SENDER_ID=your-kivra-sender-id

# Swedish Business Registry (Bolagsverket) API
BOLAGSVERKET_API_URL=https://api.bolagsverket.se/v1
BOLAGSVERKET_API_KEY=your-bolagsverket-api-key

# =============================================================================
# PAYMENT & BANKING INTEGRATION
# =============================================================================

# Stripe for international payments (if needed)
STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_WEBHOOK_SECRET=whsec_your-stripe-webhook-secret

# Swish API (Swedish mobile payment system)
SWISH_API_URL=https://mss.cpc.getswish.net
SWISH_MERCHANT_ID=your-swish-merchant-id
SWISH_CLIENT_CERT_PATH=/path/to/swish-client.p12
SWISH_CLIENT_CERT_PASSWORD=your-swish-cert-password

# Bankgirot (Swedish payment system)
BANKGIROT_API_URL=https://api.bankgirot.se
BANKGIROT_CUSTOMER_ID=your-bankgirot-customer-id
BANKGIROT_API_KEY=your-bankgirot-api-key

# Autogiro (Direct debit system)
AUTOGIRO_CUSTOMER_NUMBER=your-autogiro-customer-number
AUTOGIRO_BANK_ACCOUNT=your-bank-account-number

# =============================================================================
# FILE STORAGE & PROCESSING
# =============================================================================

# AWS S3 Configuration (Production)
AWS_REGION=eu-north-1  # Stockholm region for Swedish data residency
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_S3_BUCKET=brf-portal-documents
AWS_S3_BUCKET_REGION=eu-north-1

# Alternative: Local file storage (Development)
LOCAL_STORAGE_PATH=./storage/uploads
LOCAL_STORAGE_MAX_SIZE=100MB

# File upload limits
MAX_FILE_SIZE=50MB  # Per file
MAX_TOTAL_SIZE=500MB  # Per upload session
ALLOWED_FILE_TYPES=pdf,jpg,jpeg,png,doc,docx,xls,xlsx,txt

# Document processing queue
DOCUMENT_QUEUE_ENABLED=true
DOCUMENT_PROCESSING_TIMEOUT=300  # 5 minutes

# =============================================================================
# EMAIL SERVICES
# =============================================================================

# SMTP Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false  # true for 465, false for other ports
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-specific-password

# Email service provider alternatives
SENDGRID_API_KEY=your-sendgrid-api-key
MAILGUN_API_KEY=your-mailgun-api-key
MAILGUN_DOMAIN=your-mailgun-domain

# Email configuration
FROM_EMAIL=noreply@brfportal.se
FROM_NAME="BRF Portal"
REPLY_TO_EMAIL=support@brfportal.se

# Email templates
EMAIL_TEMPLATE_DIR=./templates/email
EMAIL_BASE_URL=https://brfportal.se

# =============================================================================
# SMS & NOTIFICATIONS
# =============================================================================

# SMS Provider (46elks - Swedish SMS service)
SMS_PROVIDER=46elks
SMS_API_URL=https://api.46elks.com/a1
SMS_API_USERNAME=your-46elks-username
SMS_API_PASSWORD=your-46elks-password
SMS_FROM_NUMBER=BRFPortal

# Alternative SMS providers
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+46700000000

# Push notifications
FIREBASE_PROJECT_ID=your-firebase-project-id
FIREBASE_PRIVATE_KEY_ID=your-firebase-private-key-id
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYOUR_PRIVATE_KEY\n-----END PRIVATE KEY-----\n"
FIREBASE_CLIENT_EMAIL=your-service-account@firebase-project.iam.gserviceaccount.com
FIREBASE_CLIENT_ID=your-firebase-client-id
FIREBASE_AUTH_URI=https://accounts.google.com/o/oauth2/auth
FIREBASE_TOKEN_URI=https://oauth2.googleapis.com/token

# =============================================================================
# ENERGY & SUSTAINABILITY APIs
# =============================================================================

# Sally R Energy API (when revenue >50k/month)
SALLY_R_API_KEY=your-sally-r-api-key
SALLY_R_API_URL=https://api.sallyr.com/v1

# Eliq Energy Data API
ELIQ_API_KEY=your-eliq-api-key
ELIQ_API_URL=https://api.eliq.se/v1

# SMHI Weather Data (Swedish Meteorological Institute - Free)
SMHI_API_URL=https://opendata-download-metobs.smhi.se/api

# Nord Pool Spot Prices (Free API)
NORDPOOL_API_URL=https://www.nordpoolgroup.com/api

# =============================================================================
# CACHING & PERFORMANCE
# =============================================================================

# Redis Configuration (Production)
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=your-redis-password
REDIS_DB=0

# Cache settings
CACHE_TTL_DEFAULT=3600  # 1 hour
CACHE_TTL_STATIC=86400  # 24 hours
CACHE_TTL_DYNAMIC=300   # 5 minutes

# Rate limiting
RATE_LIMIT_WINDOW=900   # 15 minutes
RATE_LIMIT_MAX=100      # requests per window
RATE_LIMIT_SKIP_SUCCESSFUL=true

# =============================================================================
# MONITORING & LOGGING
# =============================================================================

# Application monitoring
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=development
SENTRY_TRACE_SAMPLE_RATE=0.1

# Log level configuration
LOG_LEVEL=info  # error, warn, info, debug, trace
LOG_FORMAT=json  # json, pretty
LOG_FILE_ENABLED=true
LOG_FILE_PATH=./logs/app.log
LOG_FILE_MAX_SIZE=10MB
LOG_FILE_MAX_FILES=5

# Performance monitoring
PERFORMANCE_MONITORING_ENABLED=true
SLOW_QUERY_THRESHOLD=1000  # milliseconds

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Encryption keys (generate with: openssl rand -base64 32)
ENCRYPTION_KEY=your-32-character-encryption-key
JWT_SIGNING_KEY=your-jwt-signing-key-minimum-256-bits

# CSRF Protection
CSRF_SECRET=your-csrf-secret-key
CSRF_COOKIE_NAME=csrf-token

# Content Security Policy
CSP_ENABLED=true
CSP_REPORT_URI=/api/security/csp-report

# CORS Configuration
CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true

# Security headers
HSTS_MAX_AGE=31536000  # 1 year
HSTS_INCLUDE_SUBDOMAINS=true

# =============================================================================
# GDPR & COMPLIANCE
# =============================================================================

# Data retention policies (in days)
GDPR_DATA_RETENTION_DEFAULT=2555  # 7 years (Swedish law)
GDPR_LOG_RETENTION=90
GDPR_SESSION_RETENTION=30

# Cookie consent
COOKIE_CONSENT_REQUIRED=true
ANALYTICS_ENABLED=false  # Disable in development

# Data export/deletion
DATA_EXPORT_ENABLED=true
DATA_DELETION_ENABLED=true
DATA_ANONYMIZATION_ENABLED=true

# =============================================================================
# TESTING & DEVELOPMENT
# =============================================================================

# Test database
TEST_DATABASE_URL="file:./database/test.db"

# Mock services in development
MOCK_BANKID=true
MOCK_EMAIL=true
MOCK_SMS=true
MOCK_PAYMENT=true
MOCK_EXTERNAL_APIS=true

# Development tools
STORYBOOK_ENABLED=true
API_DOCS_ENABLED=true
DEBUG_TOOLBAR_ENABLED=true

# Seed data
SEED_TEST_USERS=true
SEED_TEST_COOPERATIVES=true
SEED_TEST_DOCUMENTS=true

# =============================================================================
# DEPLOYMENT & INFRASTRUCTURE
# =============================================================================

# Deployment environment
DEPLOYMENT_ENV=development
DEPLOYMENT_REGION=eu-north-1
DEPLOYMENT_VERSION=1.0.0

# Health check configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_ENDPOINT=/api/health
HEALTH_CHECK_TIMEOUT=5000

# Auto-scaling settings
AUTO_SCALE_MIN_INSTANCES=1
AUTO_SCALE_MAX_INSTANCES=10
AUTO_SCALE_TARGET_CPU=70

# Backup configuration
BACKUP_ENABLED=false
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_S3_BUCKET=brf-portal-backups
BACKUP_RETENTION_DAYS=90

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Core features
FEATURE_BANKID_AUTH=false
FEATURE_AI_PROCESSING=false
FEATURE_PAYMENT_PROCESSING=false
FEATURE_EMAIL_NOTIFICATIONS=true
FEATURE_SMS_NOTIFICATIONS=false

# Premium features
FEATURE_ENERGY_OPTIMIZATION=false
FEATURE_ADVANCED_ANALYTICS=false
FEATURE_WHITE_LABEL=false
FEATURE_API_ACCESS=false

# Experimental features
FEATURE_BLOCKCHAIN_DOCS=false
FEATURE_AR_INSPECTIONS=false
FEATURE_IOT_INTEGRATION=false

# =============================================================================
# API RATE LIMITS & QUOTAS
# =============================================================================

# Internal API limits
API_RATE_LIMIT_PER_HOUR=1000
API_RATE_LIMIT_PER_DAY=10000

# External API quotas
OPENAI_MONTHLY_QUOTA=1000000  # tokens
BANKID_MONTHLY_QUOTA=5000     # authentications
SMS_MONTHLY_QUOTA=1000        # messages

# =============================================================================
# MULTI-TENANT CONFIGURATION
# =============================================================================

# Tenant isolation
MULTI_TENANT_MODE=true
DEFAULT_TENANT_FEATURES=["standard"]
MAX_TENANTS_PER_INSTANCE=1000

# Subdomain routing
ENABLE_SUBDOMAIN_ROUTING=true
BASE_DOMAIN=brfportal.se
WILDCARD_DOMAIN=*.brfportal.se

# =============================================================================
# LOCALIZATION & INTERNATIONALIZATION
# =============================================================================

# Default locale (Swedish)
DEFAULT_LOCALE=sv-SE
SUPPORTED_LOCALES=sv-SE,en-US,fi-FI,da-DK,no-NO

# Currency and formatting
DEFAULT_CURRENCY=SEK
DATE_FORMAT=YYYY-MM-DD
TIME_FORMAT=HH:mm

# Translation service
TRANSLATION_API_KEY=your-translation-api-key
AUTO_TRANSLATE_ENABLED=false

# =============================================================================
# END OF CONFIGURATION
# =============================================================================

# Additional notes:
# - All sensitive values should be stored securely in production
# - Use environment-specific override files (.env.local, .env.production)
# - Regularly audit and rotate secrets
# - Document any changes to this configuration
# - Test all integrations in staging before production deployment